config {
  type: "table",
  schema: 'estrela_da_casa',
  bigquery: {
    labels: {
      schedule: "diario",
      tags: "estrela_da_casa",
      owner: "martech"
    }
  },
  description: 'Tabela com os usu치rios do raiox_assinante_estrela_da_casa e a semana em que entraram no cluster.',
  columns: {
    globo_id: 'C칩digo que identifica o usu치rio.',
    min_semana: 'Semana em que o usu치rio entrou na base raiox_assinante_estrela_da_casa.'
  }

}

WITH entrada_cluster AS (
  SELECT
    DISTINCT globo_id,
    MIN(semana) AS min_semana
  FROM
    ${ref("estrela_da_casa", "raiox_assinante_estrela_da_casa")}
  GROUP BY
    1
)
SELECT
  *
FROM
  entrada_cluster
